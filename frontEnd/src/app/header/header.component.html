<header>
  <div class="overlay" [ngClass]="{'open': menuOpen || cartMenuOpen || favsMenuOpen}" (click)="closeMenus()"></div>

  <!-- Logo -->
  <div class="logo">
    <a routerLink="/">
      <img src="logoIzqNoFondo.png" alt="Logo">
    </a>
  </div>

  <!-- Barra de búsqueda-->
  <div class="search-bar">
    <input type="text" placeholder="Buscar" (input)="buscarProducto()" [(ngModel)]="nombreBusqueda">
    <button (click)="buscarProducto()"><i class="fas fa-search"></i></button>
  </div>

  <!-- Si el usuario está logueado, muestra area personal; de lo contrario, muestra Iniciar sesion -->
  <div class="account" (click)="irAUser()">
    <i class="fas fa-user"></i>
    <span> {{ isLoggedIn ? 'Área personal' : 'Iniciar sesión' }}</span>
    <i class="fas fa-sign-out-alt" *ngIf="isLoggedIn" (click)="logout($event)"
      style="margin-left: 8px; color: red;"></i>
  </div>


  <div *ngIf="isAdmin" class="adminUsers" [routerLink]="'/admin-users'">
    <span>Lista Usuarios</span>
  </div>

  <!-- Mi cesta -->
  <div *ngIf="!isAdmin">
    <div class="cart" id="cartMenuButton" (click)="toggleCartMenu()">
      <i class="fas fa-shopping-cart"></i>
      <span>Mi cesta</span>
    </div>

    <!-- Menú lateral de la cesta -->
    <div class="cart-menu" [ngClass]="{'open': cartMenuOpen}">
      <div class="cart-menu-header">
        <span class="cart-title">Mi cesta</span>
        <button class="close-btnC" (click)="toggleCartMenu()">✕</button>
      </div>

      <div class="cart-content">
        <ng-container *ngIf="productosCesta.length > 0; else vacia">
          <ul class="cart-list">
            <li *ngFor="let producto of productosCesta; let i = index;">
              <img [src]="'/img/' + producto.imagen" alt="Producto">
              <div>
                <p><strong>{{ producto.nombre }}</strong></p>
                <p>{{ producto.precio }} €</p>
              </div>
            </li>
          </ul>
          <button (click)="vaciarCesta()" class="bt-menu">Vaciar cesta completa</button>
        </ng-container>
        <ng-template #vacia>
          <div class="cart-Ncontent">
            <img src="lensPickingPointsNoPostalCodeFound.svg" class="cart-image" alt="Cesta vacía">
            <p class="cart-text">Tu carrito está vacío</p>
            <button class="go-home-btn" [routerLink]="'/'" (click)="toggleCartMenu()">Explorar
              artículos</button>
          </div>
        </ng-template>
      </div>


      <div class="cart-menu-footer">
        <button class="go-cart-btn" (click)="irCesta()">Ver artículos en la cesta</button>
      </div>
    </div>

  </div>

  <!-- Favoritos -->
  <div *ngIf="!isAdmin">
    <div class="favs" id="favsMenuButton" (click)="toggleFavsMenu()">
      <i class="fas fa-heart"></i>
      <span>Mis Favoritos</span>
    </div>

    <!-- Menú lateral de favoritos -->
    <div class="favs-menu" [ngClass]="{'open': favsMenuOpen}">
      <div class="favs-menu-header">
        <span class="favs-title">Mis Favoritos</span>
        <button class="close-btnC" (click)="toggleFavsMenu()">✕</button>
      </div>

      <div class="favs-content">
        <ng-container *ngIf="productosFavs.length > 0; else vacia">
          <ul class="favs-list">
            <li *ngFor="let fav of productosFavs; let i = index;">
              <img [src]="'/img/' + fav.imagen" alt="Producto">
              <div>
                <p><strong>{{ fav.nombre }}</strong></p>
                <p>{{ fav.precio }} €</p>
              </div>
            </li>
          </ul>
        </ng-container>
        <ng-template #vacia>
          <div class="favs-Ncontent">
            <img src="lensPickingPointsNoPostalCodeFound.svg" class="favs-image" alt="Cesta vacía">
            <p class="favs-text">Tu lista de favoritos está vacía</p>
            <button class="go-home-btn" [routerLink]="'/'" (click)="toggleFavsMenu()">Explorar
              artículos</button>
          </div>
        </ng-template>
      </div>

      <div class="favs-menu-footer">
        <button class="go-favs-btn" (click)="irFavs()">Ver artículos en favoritos</button>
      </div>
    </div>
  </div>

  <!-- Botón modo claro/oscuro -->
  <div class="dark-mode-toggle">
    <button (click)="toggleDarkMode()">
      <i class="fas fa-moon" *ngIf="!isDarkMode"></i>
      <i class="fas fa-sun" *ngIf="isDarkMode"></i>
    </button>
  </div>

</header>